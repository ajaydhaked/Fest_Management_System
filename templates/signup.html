<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="/static/styles2.css" />
     <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  </head>
    <title>Tech Fest</title>
  </head>
  <body>
    <div class="container">
        <h1>Signup Form</h1>

        <form id="signup-form">
            <div class="form-section">
                <label for="name">Name:</label>
                <input type="text" id="name" required>

                <label for="password">Password:</label>
                <input type="password" id="password" required>

                <label for="verify-password">Verify Password:</label>
                <input type="password" id="verify-password" required>
            </div>

            <div class="slider-section">
                <label>Select Type:</label>
                <div class="slider-container">
                    <input type="radio" name="type" id="organiser" value="organiser" checked>
                    <label for="organiser">Organiser</label>
                    <input type="radio" name="type" id="student" value="student">
                    <label for="student">Student</label>
                    <input type="radio" name="type" id="outsider" value="outsider">
                    <label for="outsider">Outsider</label>
                </div>
            </div>

            <div id="organiser-fields" class="extra-fields">
                <label for="roll-no">Roll No:</label>
                <input type="text" id="roll-no" >

                <label for="roll-name">Roll Name:</label>
                <input type="text" id="roll-name" >

                <label for="enrollment-key">Enrollment Key:</label>
                <input type="text" id="enrollment-key" >
            </div>

            <div id="student-fields" class="extra-fields" style="display: none;"> 
                <label for="student-roll-no">Roll No:</label>
                <input type="text" id="student-roll-no" >
            </div>

            <div id="outsider-fields" class="extra-fields" style="display: none;">
                <label for="college">College:</label>
                <input type="text" id="college">

                <label for="outsider-roll-no">Roll No:</label>
                <input type="text" id="outsider-roll-no">

                <label for="branch">Branch:</label>
                <input type="text" id="branch" >
            </div>

            <button type="submit">Sign Up</button>
        </form>
    </div>

    <script>
      const radioButtons = document.querySelectorAll('input[name="type"]');
      const organiserFields = document.getElementById('organiser-fields');
      const studentFields = document.getElementById('student-fields');
      const outsiderFields = document.getElementById('outsider-fields');
      const signupForm = document.getElementById('signup-form');  

      function toggleExtraFields() {
          organiserFields.style.display = 'none';
          studentFields.style.display = 'none';
          outsiderFields.style.display = 'none';

          const selectedType = document.querySelector('input[name="type"]:checked').value;

          switch (selectedType) {
              case 'organiser':
                  organiserFields.style.display = 'block';
                  break;
              case 'student':
                  studentFields.style.display = 'block';
                  break;
              case 'outsider':
                  outsiderFields.style.display = 'block';
                  break;
          }
      }

      // Initial display state
      toggleExtraFields();

      // Add event listeners to radio buttons
      radioButtons.forEach(button => {
          button.addEventListener('change', toggleExtraFields);
      });

      
      signupForm.addEventListener('submit', function(event) {
          // ... other validation you might have ...


        const selectedType = document.querySelector('input[name="type"]:checked').value;

        if (selectedType === 'organiser') {
            if (document.getElementById('roll-no').value === '' ||
                document.getElementById('roll-name').value === '' ||
                document.getElementById('enrollment-key').value === '') {
                event.preventDefault();
                alert('Please fill all required fields for Organiser');
            }
        } else if (selectedType === 'student') {
            if (document.getElementById('student-roll-no').value === '') {
                event.preventDefault();
                alert('Please fill all required fields for Student');
            }
        } else if (selectedType === 'outsider') {
            if (document.getElementById('college').value === '' ||
                document.getElementById('outsider-roll-no').value === '' ||
                document.getElementById('branch').value === '') {
                event.preventDefault();
                alert('Please fill all required fields for Outsider');
            }
        }
    });

      signupForm.addEventListener('submit', async function(event) {
      event.preventDefault();

        // Collect form data (You'll need to adjust selectors or create a helper function)
        const formData = {
          name: document.getElementById('name').value,
          password: document.getElementById('password').value,
          verified_password: document.getElementById('verify-password').value,
          type: document.querySelector('input[name="type"]:checked').value
      };

      const selectedType = formData.type;
      if (selectedType === 'organiser') {
          formData.roll_no = document.getElementById('roll-no').value;
          formData.roll_name = document.getElementById('roll-name').value;
          formData.enrollment_key = document.getElementById('enrollment-key').value;
      } else if (selectedType === 'student') {
          formData.roll_no = document.getElementById('student-roll-no').value;
      } else if (selectedType === 'outsider') {
          formData.college = document.getElementById('college').value;
          formData.roll_no = document.getElementById('outsider-roll-no').value;
          formData.branch = document.getElementById('branch').value;
      }
      console.log(formData);
      // Send POST request
      const response = await fetch('/signup', {
          method: 'POST',
          headers: {
              'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData) 
      });

      if (response.ok) {
          const result = await response.json();
          alert(result.message); // Display success message
      } else {
          alert("Signup failed. Please try again.");
      }
  });
    </script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script> -->
  </body>
</html>

<!-- <img src="/static/image.jpeg" alt="An image" /> -->
